# 数据工程岗 · 笔试卷（120 分 / 120 分钟）

说明
- 覆盖：Python 基础/正则/排序、pandas、NumPy、SQL、数据工程与流水线、日志与可观测性、财税报表
- 题源：摘自 QUESTION_BANK.md（已按岗位筛选重组）。参考答案见 QUESTION_BANK_WITH_SOLUTIONS.md

计分结构
- 单选 8 题×1 分=8 分；多选 4 题×2 分=8 分；判断 4 题×1 分=4 分（小计 20）
- 简答 3 题×4 分=12 分（小计 32）
- 代码改错 3 题×5 分=15 分（小计 47）
- 编程 3 题×10 分=30 分（小计 77）
- SQL 3 题×8 分=24 分（小计 101）
- 系统设计 1 题×8 分=8 分（小计 109）
- 业务综合 1 题×11 分=11 分（总计 120）

---

## 一、单选题（每题 1 分，共 8 分）

1. A2 正则匹配“整数或小数”更鲁棒写法（题面同题库）。
2. A3 `sorted(xs, key=lambda x: (x.date, -x.amount))` 的含义（题面同题库）。
3. A5 pandas 环比/同比的常用方法（题面同题库）。
4. A6 sqlite3 参数化占位符（题面同题库）。
5. A11 含税→不含税+税额的公式（题面同题库）。
6. A12 pandas 计算月末（题面同题库）。
7. A7 日志输出推荐（题面同题库）。
8. A10 JSON Lines 读取方式（题面同题库）。

## 二、多选题（每题 2 分，共 8 分）

9. B3 pandas 合并聚合易错点（题面同题库）。
10. B4 结构化日志字段（题面同题库）。
11. B5 SQL 参数化写法（题面同题库）。
12. B6 大文件稳健处理（题面同题库）。

## 三、判断题（每题 1 分，共 4 分）

13. C1 list.append 摊还 O(1)（题面同题库）。
14. C3 `pct_change(12)` 用于同比（题面同题库）。
15. C4 sqlite3 可用 `$1` 占位（题面同题库）。
16. C2 多次 basicConfig 可覆盖旧 Handler（题面同题库）。

## 四、简答题（每题 4 分，共 12 分）

17. D4 说明 pandas merge 后为何要立即处理缺失值与 dtype，并举例（题面同题库）。
18. D6 “重试与退避”的设计原则（最大次数、抖动、幂等、超时）（题面同题库）。
19. D3 Decimal 与 float 的优缺点与舍入策略推荐（题面同题库）。

## 五、代码阅读与改错（每题 5 分，共 15 分）

20. E1 分块生成器的返回对象被清空问题（题面同题库，给出修复）。
21. E4 pandas 月末计算错误（题面同题库，给出修复）。
22. E5 SQL 字符串拼接注入风险（题面同题库，给出参数化修复）。

## 六、编程题（每题 10 分，共 30 分）

23. F5 pandas：向量化拆分含税金额，新增 `net`/`tax` 列（题面同题库）。
24. F1 金额提取与清洗（正则）：返回浮点列表（题面同题库）。
25. F4 CSV 读取并新增 `tax` 列（题面同题库）。

## 七、SQL 题（每题 8 分，共 24 分）

26. G1 左连接 org，部门汇总含税金额，NULL→'UNK'，按部门字典序（题面同题库）。
27. G2 查询 2024-03 期间发票总额（题面同题库）。
28. G3 period+dept 汇总 `amount_sum`、`tax_sum`（题面同题库）。

## 八、系统设计（8 分）

29. H3 并发导入流水线设计：扫描→解析→校验→落库→回执。说明背压/重试/隔离/幂等/吞吐权衡（题面同题库）。

## 九、业务综合（11 分）

30. I5 期间报表：按月份与部门汇总金额，输出透视表；说明缺失填充与列序控制策略（题面同题库）。

— 试卷完 —

# 软件需求规格说明书 (SRS)
# Software Requirements Specification

**项目名称**: pythonLearn - Python交互式学习平台  
**文档版本**: V2.0  
**编写日期**: 2025-11-07  
**文档状态**: 正式版  
**密级**: 内部公开

---

## 文档修订历史

| 版本 | 日期 | 修订人 | 修订内容 | 审核人 |
|------|------|--------|---------|--------|
| V1.0 | 2025-11-07 | 开发团队 | 初始版本 | - |
| V2.0 | 2025-11-07 | 开发团队 | 添加6大优化方向 | - |
| V3.0 | 2025-11-07 | 开发团队 | 结合商用系统经验完善需求 | - |

---

## 目录

1. [引言](#1-引言)
2. [项目概述](#2-项目概述)
3. [总体描述](#3-总体描述)
4. [功能需求](#4-功能需求)
5. [非功能需求](#5-非功能需求)
6. [外部接口需求](#6-外部接口需求)
7. [数据需求](#7-数据需求)
8. [约束条件](#8-约束条件)
9. [质量属性](#9-质量属性)
10. [验收标准](#10-验收标准)

---

## 1. 引言

### 1.1 目的

本文档详细描述pythonLearn Python交互式学习平台V2.0的软件需求，包括功能需求、性能需求、接口需求等。本文档面向以下读者：

- **项目管理人员**: 了解项目范围和目标
- **开发人员**: 作为开发依据
- **测试人员**: 作为测试依据
- **用户**: 了解系统功能

### 1.2 范围

**系统名称**: pythonLearn Python交互式学习平台

**系统目标**:
- 提供系统化的Python学习路径（基础→高级）
- 提供在线交互式编程环境
- 支持个性化学习规划和进度追踪
- 通过游戏化机制提升学习兴趣
- 支持单机或局域网部署（500用户以内）

**系统边界**:
- ✅ 包含: 题库管理、在线编程、学习规划、进度追踪、成就系统
- ❌ 不包含: 视频教学、在线支付、第三方课程集成

### 1.3 术语和缩略语

| 术语 | 定义 |
|------|------|
| SRS | Software Requirements Specification - 软件需求规格说明书 |
| DDS | Detailed Design Specification - 详细设计说明书 |
| MVP | Minimum Viable Product - 最小可行产品 |
| YAML | YAML Ain't Markup Language - 数据序列化格式 |
| JWT | JSON Web Token - 身份认证令牌 |
| ORM | Object-Relational Mapping - 对象关系映射 |
| AST | Abstract Syntax Tree - 抽象语法树 |
| LAN | Local Area Network - 局域网 |

### 1.4 参考资料

- [项目分析与规划总结](../PROJECT_ANALYSIS_AND_PLANNING.md)
- [优化方案文档](OPTIMIZATION_PLAN.md)
- [架构演进规划V2](ARCHITECTURE_EVOLUTION_V2.md)
- [快速开始指南](OPTIMIZATION_QUICKSTART.md)

---

## 2. 项目概述

### 2.1 产品定位

pythonLearn是一个面向Python学习者的**交互式学习平台**，提供：

- 📚 **系统化学习路径**: 8个阶段，从基础到高级
- 💻 **在线编程环境**: 实时代码执行和测试
- 🎯 **个性化学习**: 智能推荐和学习规划
- 🎮 **游戏化激励**: 积分、等级、成就系统
- 🔒 **安全可靠**: Docker沙箱隔离

### 2.2 目标用户

**主要用户群体**:
1. **Python初学者** (60%)
   - 编程零基础或基础薄弱
   - 需要系统化学习路径
   - 需要即时反馈和指导

2. **Python进阶者** (30%)
   - 有一定编程基础
   - 准备技术面试
   - 需要算法和数据结构练习

3. **企业培训** (10%)
   - 企业内部Python培训
   - 需要进度追踪和考核
   - 局域网部署需求

### 2.3 使用场景

**场景1: 个人学习**
- 用户: 大学生小王
- 目标: 学习Python准备找工作
- 使用: 每天1小时，完成8阶段学习路径
- 期望: 3个月掌握Python基础和进阶知识

**场景2: 企业培训**
- 用户: 某公司技术部门
- 目标: 培训50名员工学习Python
- 使用: 局域网部署，统一管理和考核
- 期望: 2个月完成基础培训，通过考核

**场景3: 面试准备**
- 用户: 求职者小李
- 目标: 准备Python技术面试
- 使用: 重点练习算法和数据结构题
- 期望: 1个月完成100道面试题

### 2.4 运行环境

**部署环境**:
- **单机部署**: 个人电脑（Windows/macOS/Linux）
- **局域网部署**: 企业内网服务器
- **用户规模**: 1-500人

**硬件要求**:
- **CPU**: 2核及以上
- **内存**: 4GB及以上
- **硬盘**: 10GB可用空间
- **网络**: 局域网或互联网

**软件要求**:
- **操作系统**: Linux/macOS/Windows 10+
- **Docker**: 20.10+
- **浏览器**: Chrome 90+, Firefox 88+, Safari 14+

---

## 3. 总体描述

### 3.1 产品功能

系统包含以下6大功能模块：

```
pythonLearn V2.0
├── 1. 题库管理系统
│   ├── YAML格式题目配置
│   ├── 可视化题目编辑器
│   ├── 题目分类和标签
│   └── 批量导入/导出
│
├── 2. 在线学习系统
│   ├── 代码编辑器（语法高亮、自动补全）
│   ├── 实时代码执行
│   ├── 3级渐进式提示
│   └── 代码对比和分析
│
├── 3. 用户管理系统
│   ├── 用户注册/登录
│   ├── 个人资料管理
│   ├── 权限管理（学生/教师/管理员）
│   └── JWT身份认证
│
├── 4. 学习规划系统
│   ├── 入门能力测试
│   ├── 个性化学习路径
│   ├── 智能题目推荐
│   └── 学习进度追踪
│
├── 5. 激励系统
│   ├── 积分和等级
│   ├── 排行榜
│   ├── 每日任务
│   └── 挑战赛
│
└── 6. 成就系统
    ├── 成就徽章
    ├── 学习报告
    ├── 技能树
    └── 个人荣誉墙
```

### 3.2 用户特征

| 用户类型 | 技术水平 | 使用频率 | 主要需求 |
|---------|---------|---------|---------|
| **学生** | 初级-中级 | 每天1-2小时 | 系统学习、即时反馈 |
| **教师** | 中级-高级 | 每周2-3次 | 题目管理、进度查看 |
| **管理员** | 高级 | 按需 | 系统配置、用户管理 |

### 3.3 约束条件

**技术约束**:
- 必须使用SQLite数据库（单机/局域网场景）
- 必须使用Vue.js 3前端框架
- 必须使用Docker容器化部署
- 必须支持500用户以内并发

**业务约束**:
- 代码执行时间不超过5秒
- 单个题目文件大小不超过1MB
- 题库总容量不超过5GB

**安全约束**:
- 必须使用Docker沙箱隔离代码执行
- 必须限制代码执行资源（内存128MB，CPU 50%）
- 必须禁用危险操作（文件IO、网络访问、系统调用）

### 3.4 假设和依赖

**假设**:
- 用户具备基本的计算机操作能力
- 用户可以访问现代浏览器
- 部署环境已安装Docker

**依赖**:
- Python 3.8+运行环境
- Docker 20.10+容器引擎
- SQLite 3.35+数据库

---

## 4. 功能需求

### 4.1 题库管理系统

#### 4.1.1 题目配置化 [P0]

**需求ID**: FR-TK-001
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为教师，我希望能够使用YAML格式快速添加题目，而不需要编写复杂的Python代码。

**功能描述**:
1. 支持YAML格式题目配置文件
2. 包含题目元数据（ID、标题、分类、难度、标签）
3. 包含题目内容（描述、模板、答案、测试用例）
4. 包含辅助信息（提示、知识点、相关题目）

**输入**:
```yaml
id: STR001
title: 字符串反转
category: 基础入门
difficulty: 1
estimated_time: 5
description: "编写一个函数，实现字符串反转功能"
template: "def reverse_string(s: str) -> str:\n    pass"
solution: "def reverse_string(s: str) -> str:\n    return s[::-1]"
test_cases:
  - input: ["hello"]
    output: "olleh"
```

**输出**:
- 题目成功导入数据库
- 自动生成题目ID
- 返回导入结果

**验收标准**:
- [ ] 支持YAML格式解析
- [ ] 支持所有必填字段验证
- [ ] 支持批量导入
- [ ] 导入错误有明确提示

#### 4.1.2 可视化题目编辑器 [P0]

**需求ID**: FR-TK-002
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为教师，我希望有一个可视化界面来创建和编辑题目，而不需要手动编写YAML文件。

**功能描述**:
1. 提供Web界面的题目编辑器
2. 支持所见即所得的题目编辑
3. 支持实时预览
4. 支持题目模板选择

**界面要求**:
```
┌─────────────────────────────────────────┐
│ 📝 创建新题目                            │
├─────────────────────────────────────────┤
│ 基本信息                                 │
│ 题目ID: [STR001_____]                   │
│ 标题:   [字符串反转_______________]      │
│ 分类:   [基础入门 ▼]                    │
│ 难度:   ⭐⭐⭐⭐⭐ (3星)                │
│ 预计时间: [5] 分钟                       │
│                                         │
│ 题目内容                                 │
│ 描述: [文本编辑器_______________]        │
│ 代码模板: [代码编辑器___________]        │
│ 参考答案: [代码编辑器___________]        │
│                                         │
│ 测试用例                                 │
│ [+ 添加测试用例]                         │
│ 1. 输入: ["hello"] 输出: "olleh"        │
│ 2. 输入: [""] 输出: ""                  │
│                                         │
│ [保存] [预览] [取消]                     │
└─────────────────────────────────────────┘
```

**验收标准**:
- [ ] 界面友好，易于使用
- [ ] 支持实时预览
- [ ] 支持表单验证
- [ ] 支持草稿保存

#### 4.1.3 题目分类和标签 [P1]

**需求ID**: FR-TK-003
**优先级**: 🔥🔥 中
**用户故事**: 作为学生，我希望能够按分类和标签筛选题目，快速找到我需要练习的内容。

**功能描述**:
1. 支持多级分类（一级分类、二级分类）
2. 支持多标签（一个题目可以有多个标签）
3. 支持分类和标签的组合筛选
4. 支持按难度、时长筛选

**分类体系**:
```
基础入门
├── 变量和数据类型
├── 控制流
└── 函数定义

数据处理
├── 列表和元组
├── 字典和集合
└── 文件操作

算法思维
├── 排序算法
├── 搜索算法
└── 动态规划

...
```

**验收标准**:
- [ ] 支持分类树展示
- [ ] 支持多条件筛选
- [ ] 筛选结果实时更新
- [ ] 显示题目数量统计

#### 4.1.4 批量导入/导出 [P1]

**需求ID**: FR-TK-004
**优先级**: 🔥🔥 中
**用户故事**: 作为管理员，我希望能够批量导入/导出题目，方便题库的备份和迁移。

**功能描述**:
1. 支持批量导入YAML文件
2. 支持导出为YAML/JSON/Excel格式
3. 支持选择性导出（按分类、标签）
4. 支持导入冲突处理（跳过/覆盖/重命名）

**验收标准**:
- [ ] 支持拖拽上传
- [ ] 显示导入进度
- [ ] 导入结果详细报告
- [ ] 导出文件格式正确

---

### 4.2 在线学习系统

#### 4.2.1 代码编辑器 [P0]

**需求ID**: FR-LS-001
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为学生，我希望有一个功能强大的代码编辑器，支持语法高亮、自动补全等功能。

**功能描述**:
1. 基于CodeMirror 6的代码编辑器
2. 支持Python语法高亮
3. 支持代码自动补全
4. 支持代码格式化
5. 支持错误提示
6. 支持快捷键操作

**技术要求**:
- 使用CodeMirror 6或Monaco Editor
- 支持主题切换（亮色/暗色）
- 支持字体大小调整
- 响应时间<100ms

**验收标准**:
- [ ] 语法高亮正确
- [ ] 自动补全准确
- [ ] 快捷键可用
- [ ] 性能流畅

#### 4.2.2 实时代码执行 [P0]

**需求ID**: FR-LS-002
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为学生，我希望能够实时运行代码并查看结果，而不需要离开浏览器。

**功能描述**:
1. 在Docker容器中执行用户代码
2. 运行所有测试用例
3. 显示执行结果（通过/失败）
4. 显示执行时间和内存使用
5. 显示错误信息和堆栈跟踪

**安全要求**:
- Docker容器隔离
- 内存限制: 128MB
- CPU限制: 50%
- 执行时间限制: 5秒
- 禁用网络访问
- 禁用文件系统访问

**输出格式**:
```json
{
  "success": true,
  "score": 100,
  "passed": 3,
  "total": 3,
  "execution_time": 0.15,
  "memory_used": 12.5,
  "results": [
    {
      "test_case": 1,
      "input": ["hello"],
      "expected": "olleh",
      "actual": "olleh",
      "passed": true
    }
  ]
}
```

**验收标准**:
- [ ] 代码执行成功率>99%
- [ ] 执行时间<5秒
- [ ] 安全隔离有效
- [ ] 错误信息清晰

#### 4.2.3 3级渐进式提示 [P0]

**需求ID**: FR-LS-003
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为学生，我希望在遇到困难时能够获得渐进式的提示，而不是直接看到答案。

**功能描述**:
1. 提供3级提示系统
   - Level 1: 思路提示（不涉及具体代码）
   - Level 2: 方法提示（提示使用的方法和函数）
   - Level 3: 代码提示（提供关键代码片段）
2. 查看提示需要消耗积分
3. 使用提示会影响最终得分
4. 提示内容根据题目动态生成

**积分消耗**:
- Level 1: -5分
- Level 2: -10分
- Level 3: -20分

**验收标准**:
- [ ] 提示内容准确有用
- [ ] 积分扣除正确
- [ ] 提示记录保存
- [ ] 影响最终得分

#### 4.2.4 代码对比和分析 [P1]

**需求ID**: FR-LS-004
**优先级**: 🔥🔥 中
**用户故事**: 作为学生，我希望能够对比我的代码和标准答案，了解差异和改进方向。

**功能描述**:
1. 并排显示用户代码和标准答案
2. 高亮显示差异部分
3. 提供代码质量评分
4. 提供性能对比分析
5. 提供改进建议

**验收标准**:
- [ ] Diff显示清晰
- [ ] 质量评分合理
- [ ] 建议具有参考价值

---

### 4.3 用户管理系统

#### 4.3.1 用户注册/登录 [P0]

**需求ID**: FR-UM-001
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为新用户，我希望能够快速注册账号并登录系统。

**功能描述**:
1. 支持邮箱注册
2. 支持用户名/密码登录
3. 支持记住登录状态
4. 支持密码找回
5. 使用JWT Token认证

**注册字段**:
- 用户名（必填，3-20字符，唯一）
- 邮箱（必填，格式验证，唯一）
- 密码（必填，8-20字符，包含字母和数字）
- 确认密码（必填，与密码一致）

**验收标准**:
- [ ] 注册成功率>95%
- [ ] 登录响应时间<1秒
- [ ] Token有效期24小时
- [ ] 密码加密存储

#### 4.3.2 个人资料管理 [P1]

**需求ID**: FR-UM-002
**优先级**: 🔥🔥 中
**用户故事**: 作为用户，我希望能够管理我的个人资料和偏好设置。

**功能描述**:
1. 查看和编辑个人信息
2. 修改密码
3. 设置学习偏好
4. 管理通知设置

**可编辑字段**:
- 昵称
- 头像
- 个人简介
- 学习目标
- 每日学习时长目标

**验收标准**:
- [ ] 信息更新实时生效
- [ ] 头像上传支持常见格式
- [ ] 表单验证完善

#### 4.3.3 权限管理 [P1]

**需求ID**: FR-UM-003
**优先级**: 🔥🔥 中
**用户故事**: 作为管理员，我希望能够管理用户权限，区分学生、教师和管理员角色。

**角色定义**:

| 角色 | 权限 |
|------|------|
| **学生** | 查看题目、提交代码、查看个人进度 |
| **教师** | 学生权限 + 创建/编辑题目、查看学生进度 |
| **管理员** | 教师权限 + 用户管理、系统配置 |

**验收标准**:
- [ ] 权限控制准确
- [ ] 越权访问被拦截
- [ ] 角色切换正常

---

### 4.4 学习规划系统

#### 4.4.1 入门能力测试 [P1]

**需求ID**: FR-LP-001
**优先级**: 🔥🔥 中
**用户故事**: 作为新用户，我希望通过入门测试了解自己的水平，获得个性化的学习路径。

**功能描述**:
1. 提供10-15道测试题
2. 覆盖基础到中级难度
3. 自动评估用户水平
4. 推荐合适的学习起点

**测试题分布**:
- 基础语法: 5题
- 数据结构: 3题
- 算法思维: 3题
- 综合应用: 2题

**评估结果**:
- 初级（0-40分）: 从基础入门开始
- 中级（41-70分）: 从数据处理开始
- 高级（71-100分）: 从算法思维开始

**验收标准**:
- [ ] 测试题难度合理
- [ ] 评估结果准确
- [ ] 推荐路径合适

#### 4.4.2 个性化学习路径 [P1]

**需求ID**: FR-LP-002
**优先级**: 🔥🔥 中
**用户故事**: 作为学生，我希望系统能够根据我的水平和目标，生成个性化的学习计划。

**功能描述**:
1. 根据入门测试结果推荐起点
2. 根据学习目标设定终点
3. 根据可用时间规划进度
4. 动态调整学习计划

**输入参数**:
- 当前水平（初级/中级/高级）
- 学习目标（基础掌握/面试准备/项目实战）
- 可用时间（每周小时数）
- 目标完成日期

**输出**:
```
学习计划（12周）
├── Week 1-2: 基础入门 (20题)
├── Week 3-4: 数据处理 (15题)
├── Week 5-6: 算法思维 (30题)
├── Week 7-8: 并发编程 (20题)
├── Week 9-10: 工程实践 (25题)
└── Week 11-12: 综合项目 (10题)

预计总时长: 60小时
每周学习: 5小时
```

**验收标准**:
- [ ] 计划生成合理
- [ ] 时间估算准确
- [ ] 支持计划调整

#### 4.4.3 智能题目推荐 [P1]

**需求ID**: FR-LP-003
**优先级**: 🔥🔥 中
**用户故事**: 作为学生，我希望系统能够根据我的学习情况，智能推荐适合我的题目。

**功能描述**:
1. 分析用户知识点掌握情况
2. 识别薄弱环节
3. 推荐针对性题目
4. 考虑题目难度梯度

**推荐算法**:
```python
def recommend_questions(user_profile, count=5):
    # 1. 找出弱项知识点（正确率<70%）
    weak_points = get_weak_knowledge_points(user_profile)

    # 2. 找出相关题目
    candidates = get_questions_by_knowledge(weak_points)

    # 3. 过滤已完成题目
    candidates = filter_completed(candidates, user_profile)

    # 4. 按难度排序（从易到难）
    candidates = sort_by_difficulty(candidates)

    # 5. 返回前N个
    return candidates[:count]
```

**验收标准**:
- [ ] 推荐题目相关性高
- [ ] 难度梯度合理
- [ ] 推荐结果多样化

#### 4.4.4 学习进度追踪 [P0]

**需求ID**: FR-LP-004
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为学生，我希望能够清晰地看到我的学习进度和统计数据。

**功能描述**:
1. 显示总体进度（完成题目数/总题目数）
2. 显示各阶段进度
3. 显示学习时长统计
4. 显示知识点掌握情况
5. 显示学习趋势图表

**统计指标**:
- 总学习天数
- 总学习时长
- 完成题目数
- 平均得分
- 连续学习天数
- 各知识点掌握率

**可视化要求**:
- 进度条显示
- 饼图（题目分布）
- 折线图（学习趋势）
- 雷达图（知识点掌握）

**验收标准**:
- [ ] 数据统计准确
- [ ] 图表显示清晰
- [ ] 实时更新

---

### 4.5 激励系统

#### 4.5.1 积分和等级 [P1]

**需求ID**: FR-IS-001
**优先级**: 🔥🔥 中
**用户故事**: 作为学生，我希望通过完成题目获得积分和升级，增加学习的成就感。

**功能描述**:
1. 完成题目获得积分
2. 积分累积自动升级
3. 不同等级解锁不同权益
4. 显示等级进度

**积分规则**:
```yaml
获得积分:
  完成1星题: +10分
  完成2星题: +20分
  完成3星题: +50分
  完成4星题: +100分
  完成5星题: +200分
  首次通过: +10分
  完美通过(无提示): +20分
  连续学习: +5分/天

消耗积分:
  查看Level1提示: -5分
  查看Level2提示: -10分
  查看Level3提示: -20分
  查看答案: -30分
```

**等级系统**:
```yaml
Lv.1 Python新手: 0分
Lv.2 Python学徒: 100分
Lv.3 Python初学者: 300分
Lv.4 Python学习者: 600分
Lv.5 Python实践者: 1000分
Lv.6 Python开发者: 1500分
Lv.7 Python高手: 2000分
Lv.8 Python专家: 3000分
Lv.9 Python大师: 4500分
Lv.10 Python宗师: 6000分
```

**等级权益**:
- Lv.3: 解锁算法进阶题库
- Lv.5: 每日额外3次提示
- Lv.7: 解锁并发编程题库
- Lv.9: 解锁系统设计题库

**验收标准**:
- [ ] 积分计算准确
- [ ] 升级触发正常
- [ ] 权益解锁有效

#### 4.5.2 排行榜 [P1]

**需求ID**: FR-IS-002
**优先级**: 🔥🔥 中
**用户故事**: 作为学生，我希望看到排行榜，了解自己在所有用户中的排名。

**功能描述**:
1. 总排行榜（按总积分）
2. 周排行榜（按本周积分）
3. 月排行榜（按本月积分）
4. 好友排行榜（仅显示好友）

**排行榜字段**:
- 排名
- 用户名
- 等级
- 积分
- 完成题目数

**更新频率**:
- 总榜: 实时更新
- 周榜: 每小时更新
- 月榜: 每天更新

**验收标准**:
- [ ] 排名计算准确
- [ ] 更新及时
- [ ] 性能良好（<1秒）

#### 4.5.3 每日任务 [P2]

**需求ID**: FR-IS-003
**优先级**: 🔥 低
**用户故事**: 作为学生，我希望有每日任务引导我养成学习习惯。

**功能描述**:
1. 每日任务列表
2. 任务完成自动检测
3. 完成任务获得奖励
4. 全部完成额外奖励

**每日任务示例**:
```yaml
每日任务:
  - 登录签到: +5分
  - 完成1道题: +10分
  - 学习30分钟: +15分
  - 完成3道题: +30分
  - 帮助1位同学: +20分

全部完成奖励: +20分
```

**验收标准**:
- [ ] 任务每日刷新
- [ ] 完成检测准确
- [ ] 奖励发放正确

---

### 4.6 成就系统

#### 4.6.1 成就徽章 [P2]

**需求ID**: FR-AS-001
**优先级**: 🔥 低
**用户故事**: 作为学生，我希望通过完成特定目标获得徽章，展示我的学习成果。

**功能描述**:
1. 定义多种成就徽章
2. 自动检测成就达成
3. 发放徽章和奖励
4. 展示徽章墙

**成就分类**:

**基础成就**:
- 🎓 新手上路: 完成第1道题 (+10分)
- 📚 初窥门径: 完成10道题 (+50分)
- 🏅 小有所成: 完成50道题 (+200分)
- 🏆 登堂入室: 完成100道题 (+500分)

**专项成就**:
- 🧮 算法大师: 完成所有算法题 (+300分)
- 📊 数据专家: 完成所有数据处理题 (+300分)
- ⚡ 并发高手: 完成所有并发编程题 (+400分)

**特殊成就**:
- 💎 完美主义者: 连续10道题不使用提示 (+200分)
- 🚀 速度之王: 在规定时间50%内完成题目 (+150分)
- 🤝 助人为乐: 帮助10位同学 (+100分)
- 🔥 坚持不懈: 连续学习30天 (+300分)

**验收标准**:
- [ ] 成就检测准确
- [ ] 徽章发放及时
- [ ] 展示效果美观

#### 4.6.2 学习报告 [P2]

**需求ID**: FR-AS-002
**优先级**: 🔥 低
**用户故事**: 作为学生，我希望定期收到学习报告，了解我的学习情况和改进方向。

**功能描述**:
1. 自动生成周报和月报
2. 包含学习统计数据
3. 包含知识点掌握分析
4. 包含学习建议

**周报内容**:
```
📊 本周学习报告 (2024-01-15 ~ 2024-01-21)

学习概况:
- ⏱️ 学习时长: 12小时30分钟
- 📝 完成题目: 18道
- ⭐ 平均得分: 87分
- 🔥 连续学习: 7天

时间分布:
一 ██ 2h
二 ███ 2.5h
三 █ 1h
四 ████ 3h
五 ██ 2h
六 ░░ 0h
日 ██ 2h

知识点掌握:
✅ 字符串操作    95%
✅ 列表推导式    85%
⚠️ 正则表达式    65%
⚠️ 装饰器        45%

本周亮点:
🎉 获得"小有所成"徽章
🎉 进入周榜前10名
🎉 帮助3位同学解决问题

下周建议:
💡 加强正则表达式练习
💡 学习装饰器相关知识
💡 保持每天2小时学习
```

**验收标准**:
- [ ] 报告数据准确
- [ ] 建议有参考价值
- [ ] 支持导出PDF

#### 4.6.3 技能树 [P2]

**需求ID**: FR-AS-003
**优先级**: 🔥 低
**用户故事**: 作为学生，我希望看到技能树，了解我的技能发展路径。

**功能描述**:
1. 可视化技能树
2. 显示已解锁和未解锁技能
3. 显示技能等级
4. 显示解锁条件

**技能树结构**:
```
                Python大师
                   🏆
                   |
    ┌──────────────┼──────────────┐
    |              |              |
算法专家        数据专家        工程专家
  🧮              📊              🔧
  |              |              |
┌──┴──┐        ┌──┴──┐        ┌──┴──┐
|     |        |     |        |     |
排序  搜索     Pandas NumPy   测试  部署
✅    ✅       ✅    ⏳      ⏳    ⏳
```

**验收标准**:
- [ ] 技能树显示清晰
- [ ] 解锁逻辑正确
- [ ] 交互体验良好

---

### 4.7 系统管理功能

#### 4.7.1 数据备份与恢复 [P0]

**需求ID**: FR-SM-001
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为管理员，我希望能够定期备份数据并在需要时恢复，以保证数据安全。

**功能描述**:
1. 自动备份功能
   - 每日自动备份数据库
   - 保留最近30天的备份
   - 备份文件压缩存储
   - 备份完成后发送通知

2. 手动备份功能
   - 支持一键手动备份
   - 支持选择备份内容（全量/增量）
   - 显示备份进度
   - 生成备份报告

3. 数据恢复功能
   - 查看备份历史
   - 选择备份点恢复
   - 恢复前数据预览
   - 恢复后数据验证

4. 备份管理
   - 查看备份列表
   - 下载备份文件
   - 删除过期备份
   - 备份空间监控

**验收标准**:
- [ ] 自动备份每日执行
- [ ] 备份文件完整可用
- [ ] 恢复功能正常
- [ ] 备份不影响系统性能

#### 4.7.2 系统监控与日志 [P0]

**需求ID**: FR-SM-002
**优先级**: 🔥🔥🔥 高
**用户故事**: 作为管理员，我希望能够监控系统运行状态和查看日志，以便及时发现和解决问题。

**功能描述**:
1. 实时监控
   - CPU使用率
   - 内存使用率
   - 磁盘使用率
   - 网络流量
   - 在线用户数
   - API响应时间
   - 代码执行队列长度

2. 日志管理
   - 访问日志（用户登录、页面访问）
   - 操作日志（题目创建、修改、删除）
   - 错误日志（系统错误、异常）
   - 安全日志（登录失败、权限拒绝）
   - 性能日志（慢查询、超时）

3. 告警功能
   - CPU使用率>80%告警
   - 内存使用率>80%告警
   - 磁盘空间<10%告警
   - 错误率>5%告警
   - 响应时间>2秒告警

4. 日志查询
   - 按时间范围查询
   - 按日志级别过滤
   - 按用户/操作类型过滤
   - 关键词搜索
   - 导出日志

**验收标准**:
- [ ] 监控数据实时更新
- [ ] 日志记录完整准确
- [ ] 告警及时触发
- [ ] 日志查询响应快速

#### 4.7.3 用户行为分析 [P1]

**需求ID**: FR-SM-003
**优先级**: 🔥🔥 中
**用户故事**: 作为管理员，我希望了解用户的学习行为和使用习惯，以优化平台功能。

**功能描述**:
1. 用户活跃度分析
   - 日活跃用户数（DAU）
   - 周活跃用户数（WAU）
   - 月活跃用户数（MAU）
   - 用户留存率（次日/7日/30日）
   - 用户流失率

2. 学习行为分析
   - 平均学习时长
   - 题目完成率
   - 题目通过率
   - 提示使用率
   - 学习路径分析

3. 功能使用分析
   - 功能使用频率
   - 功能使用时长
   - 功能转化率
   - 用户反馈统计

4. 数据可视化
   - 趋势图表
   - 漏斗分析
   - 热力图
   - 用户画像

**验收标准**:
- [ ] 数据统计准确
- [ ] 图表展示清晰
- [ ] 支持自定义时间范围
- [ ] 支持导出报表

#### 4.7.4 系统配置管理 [P1]

**需求ID**: FR-SM-004
**优先级**: 🔥🔥 中
**用户故事**: 作为管理员，我希望能够灵活配置系统参数，以适应不同的使用场景。

**功能描述**:
1. 基础配置
   - 系统名称和Logo
   - 欢迎语和公告
   - 联系方式
   - 版权信息

2. 功能开关
   - 用户注册开关
   - 评论功能开关
   - 排行榜开关
   - 成就系统开关

3. 性能配置
   - 代码执行超时时间
   - 内存限制
   - CPU限制
   - 并发数限制

4. 安全配置
   - 密码强度要求
   - 登录失败次数限制
   - Token有效期
   - IP白名单/黑名单

**验收标准**:
- [ ] 配置修改即时生效
- [ ] 配置项有合理默认值
- [ ] 配置修改有日志记录
- [ ] 支持配置导入导出

#### 4.7.5 批量操作功能 [P1]

**需求ID**: FR-SM-005
**优先级**: 🔥🔥 中
**用户故事**: 作为教师/管理员，我希望能够批量操作题目和用户，以提高工作效率。

**功能描述**:
1. 批量题目操作
   - 批量导入题目（Excel/CSV/YAML）
   - 批量导出题目
   - 批量修改题目属性（分类、难度、标签）
   - 批量删除题目
   - 批量发布/下架题目

2. 批量用户操作
   - 批量导入用户（Excel/CSV）
   - 批量导出用户数据
   - 批量修改用户角色
   - 批量重置密码
   - 批量禁用/启用用户

3. 批量数据清理
   - 批量删除过期提交记录
   - 批量清理无效日志
   - 批量归档历史数据

**验收标准**:
- [ ] 支持大批量操作（1000+条）
- [ ] 操作进度实时显示
- [ ] 操作失败有详细错误信息
- [ ] 支持操作回滚

---

## 5. 非功能需求

### 5.1 性能需求

#### 5.1.1 响应时间

| 操作 | 响应时间要求 | 目标 |
|------|-------------|------|
| 页面加载 | <2秒 | <1秒 |
| API请求 | <500ms | <200ms |
| 代码执行 | <5秒 | <3秒 |
| 数据库查询 | <100ms | <50ms |
| 文件上传 | <3秒 | <2秒 |

#### 5.1.2 并发性能

| 指标 | 要求 | 目标 |
|------|------|------|
| 并发用户数 | 100 | 500 |
| 每秒请求数 | 100 QPS | 500 QPS |
| 数据库连接数 | 50 | 100 |
| 代码执行队列 | 20 | 50 |

#### 5.1.3 资源使用

| 资源 | 限制 |
|------|------|
| 服务器内存 | <2GB |
| 服务器CPU | <50% |
| 数据库大小 | <5GB |
| 单个容器内存 | <128MB |
| 单个容器CPU | <50% |

### 5.2 可靠性需求

#### 5.2.1 可用性

- **系统可用性**: ≥99.5%（单机部署）
- **数据备份**: 每日自动备份
- **故障恢复**: <1小时
- **数据丢失**: 0容忍

#### 5.2.2 容错性

- **代码执行失败**: 自动重试1次
- **数据库连接失败**: 自动重连
- **文件上传失败**: 提示用户重试
- **网络超时**: 30秒超时，友好提示

#### 5.2.3 数据完整性

- **事务支持**: 关键操作使用事务
- **数据验证**: 输入数据严格验证
- **并发控制**: 乐观锁防止冲突
- **数据备份**: 支持增量备份

### 5.3 安全性需求

#### 5.3.1 身份认证

- **密码强度**: 8-20字符，包含字母和数字
- **密码存储**: BCrypt加密，加盐
- **Token机制**: JWT Token，24小时有效期
- **会话管理**: 支持单点登录

#### 5.3.2 权限控制

- **角色权限**: 基于角色的访问控制（RBAC）
- **API鉴权**: 所有API需要Token验证
- **越权检查**: 严格检查用户权限
- **操作审计**: 记录关键操作日志

#### 5.3.3 代码执行安全

- **容器隔离**: Docker容器隔离
- **资源限制**: 内存128MB，CPU 50%
- **时间限制**: 5秒超时
- **网络隔离**: 禁用网络访问
- **文件系统**: 只读文件系统
- **危险操作**: 禁用import os, sys, subprocess等

#### 5.3.4 数据安全

- **SQL注入**: 使用ORM，参数化查询
- **XSS攻击**: 输出转义
- **CSRF攻击**: CSRF Token验证
- **文件上传**: 类型和大小限制
- **敏感数据**: 加密存储

### 5.4 可维护性需求

#### 5.4.1 代码质量

- **代码规范**: PEP 8（Python），ESLint（JavaScript）
- **注释覆盖**: ≥30%
- **函数复杂度**: 圈复杂度<10
- **代码重复**: <5%

#### 5.4.2 测试覆盖

- **单元测试**: ≥80%覆盖率
- **集成测试**: 核心功能100%覆盖
- **E2E测试**: 关键流程100%覆盖
- **性能测试**: 定期执行

#### 5.4.3 文档完善

- **API文档**: Swagger/OpenAPI
- **代码文档**: Docstring
- **用户文档**: 使用手册
- **部署文档**: 部署指南

### 5.5 可扩展性需求

#### 5.5.1 模块化设计

- **前后端分离**: RESTful API
- **组件化**: Vue组件
- **插件化**: 支持插件扩展
- **配置化**: 配置文件管理

#### 5.5.2 数据库扩展

- **表结构**: 预留扩展字段
- **索引优化**: 合理创建索引
- **分页查询**: 大数据量分页
- **缓存机制**: 热数据缓存

### 5.6 兼容性需求

#### 5.6.1 浏览器兼容

| 浏览器 | 最低版本 |
|--------|---------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

#### 5.6.2 操作系统兼容

| 操作系统 | 版本 |
|---------|------|
| Linux | Ubuntu 20.04+, CentOS 7+ |
| macOS | 11.0+ |
| Windows | 10+ |

#### 5.6.3 移动端兼容

- **响应式设计**: 支持手机和平板
- **触摸优化**: 触摸操作友好
- **性能优化**: 移动端性能优化

### 5.7 可观测性需求

#### 5.7.1 日志记录

- **日志级别**: DEBUG/INFO/WARNING/ERROR/CRITICAL
- **日志格式**: 结构化日志（JSON格式）
- **日志内容**: 时间戳、用户ID、操作类型、请求参数、响应结果、耗时
- **日志轮转**: 单文件最大10MB，保留最近10个文件
- **日志存储**: 本地文件 + 可选远程日志服务

#### 5.7.2 性能监控

- **响应时间监控**: 记录每个API的响应时间
- **慢查询监控**: 记录执行时间>100ms的数据库查询
- **资源使用监控**: CPU、内存、磁盘、网络
- **错误率监控**: 统计各类错误的发生频率

#### 5.7.3 业务指标监控

- **用户指标**: 注册数、活跃数、留存率
- **学习指标**: 题目完成数、通过率、学习时长
- **系统指标**: 请求量、并发数、成功率

### 5.8 容错和恢复需求

#### 5.8.1 故障处理

- **数据库连接失败**: 自动重连，最多重试3次
- **代码执行超时**: 5秒超时，返回友好提示
- **文件上传失败**: 提示用户重试，保留上传进度
- **网络异常**: 自动重试，显示离线提示

#### 5.8.2 数据一致性

- **事务支持**: 关键操作使用数据库事务
- **并发控制**: 使用乐观锁防止数据冲突
- **数据校验**: 输入数据严格校验
- **数据备份**: 每日自动备份，保留30天

#### 5.8.3 降级策略

- **代码执行降级**: 队列满时提示稍后重试
- **推荐系统降级**: 推荐服务异常时返回默认题目列表
- **排行榜降级**: 计算异常时显示缓存数据
- **成就系统降级**: 计算异常时延迟发放

---

## 6. 外部接口需求

### 6.1 用户界面

#### 6.1.1 界面风格

- **设计语言**: Material Design / Ant Design
- **主题**: 支持亮色/暗色主题
- **响应式**: 支持桌面和移动端
- **国际化**: 支持中英文切换

#### 6.1.2 交互设计

- **操作反馈**: 所有操作有明确反馈
- **错误提示**: 友好的错误提示
- **加载状态**: 显示加载动画
- **快捷键**: 支持常用快捷键

### 6.2 API接口

#### 6.2.1 RESTful API

**基础URL**: `http://localhost:5000/api/v1`

**认证方式**: Bearer Token (JWT)

**响应格式**:
```json
{
  "code": 200,
  "message": "success",
  "data": {...}
}
```

**错误格式**:
```json
{
  "code": 400,
  "message": "Invalid input",
  "errors": [...]
}
```

#### 6.2.2 主要API端点

**用户相关**:
- `POST /auth/register` - 用户注册
- `POST /auth/login` - 用户登录
- `GET /users/profile` - 获取个人信息
- `PUT /users/profile` - 更新个人信息

**题目相关**:
- `GET /questions` - 获取题目列表
- `GET /questions/:id` - 获取题目详情
- `POST /questions` - 创建题目（教师）
- `PUT /questions/:id` - 更新题目（教师）

**提交相关**:
- `POST /submissions` - 提交代码
- `GET /submissions/:id` - 获取提交详情
- `GET /submissions/user/:userId` - 获取用户提交历史

**学习相关**:
- `GET /progress` - 获取学习进度
- `GET /recommendations` - 获取推荐题目
- `GET /reports/weekly` - 获取周报
- `GET /achievements` - 获取成就列表

### 6.3 数据库接口

**数据库类型**: SQLite 3.35+

**连接方式**: SQLAlchemy ORM

**连接字符串**: `sqlite:///pythonlearn.db`

---

## 7. 约束条件

### 7.1 技术约束

- 必须使用SQLite数据库
- 必须使用Vue.js 3前端框架
- 必须使用Docker容器化部署
- 必须使用Python 3.8+
- 必须支持500用户以内并发

### 7.2 业务约束

- 代码执行时间不超过5秒
- 单个题目文件大小不超过1MB
- 题库总容量不超过5GB
- 用户上传文件不超过10MB

### 7.3 法律约束

- 遵守《网络安全法》
- 遵守《数据安全法》
- 遵守《个人信息保护法》
- 用户数据加密存储

---

## 8. 数据需求

### 8.1 数据模型

#### 8.1.1 核心实体

**用户实体**:
- 用户ID（主键）
- 用户名（唯一）
- 邮箱（唯一）
- 密码哈希
- 角色（学生/教师/管理员）
- 等级、积分
- 注册时间、最后登录时间

**题目实体**:
- 题目ID（主键）
- 标题、描述
- 类型、分类、难度
- 代码模板、参考答案
- 测试用例
- 知识点标签
- 创建者、创建时间

**提交实体**:
- 提交ID（主键）
- 用户ID（外键）
- 题目ID（外键）
- 提交代码
- 执行结果、得分
- 提交时间

**学习进度实体**:
- 用户ID（外键）
- 题目ID（外键）
- 状态（未开始/进行中/已完成）
- 最佳得分
- 完成时间

#### 8.1.2 实体关系

```
用户 1:N 提交
用户 1:N 学习进度
用户 M:N 成就
题目 1:N 提交
题目 1:N 测试用例
题目 M:N 知识点
题目 1:N 提示
```

### 8.2 数据量估算

#### 8.2.1 初期数据量（500用户）

| 数据类型 | 预估数量 | 单条大小 | 总大小 |
|---------|---------|---------|--------|
| 用户 | 500 | 1KB | 500KB |
| 题目 | 500 | 5KB | 2.5MB |
| 测试用例 | 2000 | 0.5KB | 1MB |
| 提交记录 | 50,000 | 2KB | 100MB |
| 学习进度 | 250,000 | 0.2KB | 50MB |
| 日志 | - | - | 500MB/月 |
| **总计** | - | - | **~1GB** |

#### 8.2.2 数据增长预测

- **用户增长**: 50人/月
- **题目增长**: 20题/月
- **提交记录**: 10,000条/月
- **日志增长**: 500MB/月

**1年后预估**: ~8GB

### 8.3 数据保留策略

#### 8.3.1 数据保留期限

| 数据类型 | 保留期限 | 归档策略 |
|---------|---------|---------|
| 用户数据 | 永久 | - |
| 题目数据 | 永久 | - |
| 提交记录 | 1年 | 超过1年归档 |
| 学习进度 | 永久 | - |
| 访问日志 | 3个月 | 超过3个月删除 |
| 错误日志 | 6个月 | 超过6个月删除 |
| 操作日志 | 1年 | 超过1年归档 |

#### 8.3.2 数据清理

- **自动清理**: 每周执行一次
- **清理内容**: 过期日志、临时文件、无效数据
- **清理前备份**: 清理前自动备份
- **清理报告**: 生成清理报告

### 8.4 数据安全

#### 8.4.1 敏感数据保护

- **密码**: BCrypt加密，加盐
- **邮箱**: 脱敏显示（例如：a***@example.com）
- **个人信息**: 加密存储
- **日志**: 脱敏处理，不记录密码等敏感信息

#### 8.4.2 数据访问控制

- **最小权限原则**: 用户只能访问自己的数据
- **角色权限**: 教师可访问学生学习数据，管理员可访问所有数据
- **审计日志**: 记录所有数据访问操作
- **数据导出**: 需要管理员权限

#### 8.4.3 数据备份

- **备份频率**: 每日自动备份
- **备份方式**: 全量备份 + 增量备份
- **备份存储**: 本地存储 + 可选远程存储
- **备份验证**: 定期验证备份可用性
- **恢复测试**: 每月执行一次恢复测试

---

## 9. 质量属性

### 9.1 可用性（Usability）

#### 9.1.1 易学性
- 新用户5分钟内完成注册和第一道题
- 提供新手引导和帮助文档
- 界面简洁直观，符合用户习惯

#### 9.1.2 易用性
- 常用功能不超过3次点击
- 提供快捷键支持
- 错误提示清晰友好
- 支持撤销/重做操作

#### 9.1.3 无障碍性
- 支持键盘导航
- 支持屏幕阅读器
- 颜色对比度符合WCAG 2.1标准
- 字体大小可调节

### 9.2 可靠性（Reliability）

#### 9.2.1 成熟度
- 核心功能稳定可靠
- 无严重Bug
- 异常情况有友好提示

#### 9.2.2 容错性
- 输入错误有提示和纠正建议
- 网络异常自动重试
- 数据库连接失败自动重连

#### 9.2.3 可恢复性
- 系统崩溃后自动恢复
- 数据丢失可从备份恢复
- 恢复时间<1小时

### 9.3 性能效率（Performance Efficiency）

#### 9.3.1 时间特性
- 页面加载时间<2秒
- API响应时间<500ms
- 代码执行时间<5秒
- 数据库查询<100ms

#### 9.3.2 资源利用
- 服务器内存使用<2GB
- 服务器CPU使用<50%
- 数据库大小<5GB
- 前端资源<5MB

#### 9.3.3 容量
- 支持500并发用户
- 支持10,000题目
- 支持1,000,000提交记录

### 9.4 可维护性（Maintainability）

#### 9.4.1 模块化
- 前后端分离
- 组件化开发
- 服务化架构

#### 9.4.2 可测试性
- 单元测试覆盖率≥80%
- 集成测试覆盖核心功能
- E2E测试覆盖关键流程

#### 9.4.3 可修改性
- 代码结构清晰
- 注释完善
- 文档齐全

### 9.5 可移植性（Portability）

#### 9.5.1 适应性
- 支持Linux/macOS/Windows
- 支持Docker部署
- 支持云平台部署

#### 9.5.2 易安装性
- 一键部署脚本
- 自动化安装
- 配置简单

---

## 10. 验收标准

### 8.1 功能验收

**P0功能（必须实现）**:
- [ ] 用户注册/登录
- [ ] 题目YAML配置
- [ ] 代码编辑器
- [ ] 实时代码执行
- [ ] 3级渐进式提示
- [ ] 学习进度追踪

**P1功能（重要）**:
- [ ] 题目管理后台
- [ ] 个性化学习路径
- [ ] 智能题目推荐
- [ ] 积分和等级系统
- [ ] 排行榜

**P2功能（可选）**:
- [ ] 成就徽章
- [ ] 学习报告
- [ ] 每日任务
- [ ] 技能树

### 8.2 性能验收

- [ ] 页面加载时间<2秒
- [ ] API响应时间<500ms
- [ ] 代码执行时间<5秒
- [ ] 支持100并发用户
- [ ] 数据库查询<100ms

### 8.3 安全验收

- [ ] 密码BCrypt加密
- [ ] JWT Token认证
- [ ] Docker容器隔离
- [ ] SQL注入防护
- [ ] XSS攻击防护
- [ ] CSRF攻击防护

### 10.4 质量验收

- [ ] 单元测试覆盖率≥80%
- [ ] 集成测试通过率100%
- [ ] 代码规范检查通过
- [ ] 无严重Bug
- [ ] 用户满意度≥4.0/5

### 10.5 文档验收

- [ ] 用户手册完整
- [ ] API文档完整
- [ ] 部署文档完整
- [ ] 运维文档完整
- [ ] 代码注释≥30%

### 10.6 上线验收

#### 10.6.1 上线前检查清单

**功能检查**:
- [ ] 所有P0功能正常工作
- [ ] 所有P1功能正常工作
- [ ] 关键业务流程测试通过
- [ ] 兼容性测试通过

**性能检查**:
- [ ] 压力测试通过（100并发用户）
- [ ] 响应时间符合要求
- [ ] 资源使用在限制范围内
- [ ] 无内存泄漏

**安全检查**:
- [ ] 安全扫描无高危漏洞
- [ ] 渗透测试通过
- [ ] 敏感数据加密
- [ ] 权限控制正确

**数据检查**:
- [ ] 数据库备份正常
- [ ] 数据迁移脚本测试通过
- [ ] 数据完整性验证通过
- [ ] 数据恢复测试通过

**运维检查**:
- [ ] 监控系统正常
- [ ] 日志系统正常
- [ ] 告警系统正常
- [ ] 部署脚本测试通过

#### 10.6.2 上线后验证

**第1天**:
- [ ] 系统稳定运行24小时
- [ ] 无严重错误
- [ ] 用户反馈收集
- [ ] 性能指标正常

**第1周**:
- [ ] 用户活跃度达标
- [ ] 功能使用率统计
- [ ] 问题修复及时
- [ ] 用户满意度调查

**第1月**:
- [ ] 系统稳定性达标
- [ ] 性能指标达标
- [ ] 用户留存率达标
- [ ] 业务指标达标

---

## 附录

### A. 数据字典

详见《详细设计文档》第5章

### B. 用例图

详见《详细设计文档》第3章

### C. 界面原型

详见《详细设计文档》第4章

---

**文档结束**

**编写**: 开发团队
**审核**: 待定
**批准**: 待定
**日期**: 2025-11-07


